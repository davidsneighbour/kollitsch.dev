{{- $post := . -}}
{{- $posttype := $post.Type -}}
{{- $config := partial "func/getPostSetup.html" $posttype -}}

{{- /* create content parts based on content type */ -}}

{{- $articleclasses := partials.Include "func/getArticleClasses.html" $post $post -}}
<article class="{{- $articleclasses -}}">

  {{- partial "template-note" (dict "note" "post-preview.html") -}}

  {{- /* MARK: Banner
  */ -}}
  {{- if ne $config.banner false -}}
    {{- partials.Include "content/components/banner.html" $post -}}
  {{- end -}}

  {{- /* MARK: Video banner
  */ -}}
  {{- if ne $config.videobanner false -}}
    {{- partials.Include "content/components/banner-video.html" $post -}}
  {{- end -}}

  {{- /* MARK: Headline
  */ -}}
  {{- if ne $config.headline false -}}
    {{- $options := dict "post" $post "level" "3" -}}
    {{- partials.Include "content/components/headline.html" $options -}}
  {{- end -}}

  {{- /* MARK: Headline-Banner
  */ -}}
  {{- if ne $config.bannerheadline false -}}
    {{- partials.Include "content/components/headline-banner.html" $post -}}
  {{- end -}}

  {{- /* MARK: Content
  */ -}}
  <div class="prose">
    {{- partials.Include "func/hook.html" ( collections.Dictionary "hook" "post-preview-before" "context" $post ) -}}
		<p class="text-truncate text-truncate-3">
      {{- /* @todo move into summary function */ -}}
			{{- with $post.Summary -}}
				{{- . | transform.Markdownify -}}
			{{- else -}}
				{{- with $post.Description -}}
					{{- . | transform.Markdownify -}}
				{{- else -}}
					{{- $post.Content | transform.Plainify | strings.Truncate 200 -}}
				{{- end -}}
			{{- end -}}
		</p>
    {{- partials.Include "func/hook.html" ( collections.Dictionary "hook" "post-preview-after" "context" $post ) -}}
  </div>

  {{- /* MARK: Read more button
  */ -}}
	<div class="text-end">
    {{- /* @todo move into button component */ -}}
    {{- $label := printf "%s: %s" (lang.Translate "theme.read_article") $post.Title -}}
		<a href="{{- $post.Permalink -}}"
        class="d-inline-flex flex-row justify-content-end align-items-center"
        aria-label="{{- $label }}">
      <span class="d-inline-block pe-2">
        {{- lang.Translate "theme.read_article" -}}
      </span>
      {{- $options := dict "icon" "chevron-double-right" "class" "d-inline-block mb-1" "width" "24" "height" "24" -}}
			{{- partials.Include "icon.html" $options -}}
		</a>
  </div>

</article>
