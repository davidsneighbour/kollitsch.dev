---
// @todo refactor and comment
// @see https://schema.org/BlogPosting
import type { CollectionEntry } from "astro:content";

import setup from "@data/setup.json" with { type: "json" };
import { formatISO8601Local } from "@utils/datetime.ts";

export interface Props {
  post: CollectionEntry<"blog">;
}

const { post }: Props = Astro.props;
const schema = {
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  author: {
    "@type": "Person",
    name: setup.author.name,
    url: setup.author.url,
  },
  description: post.data.description,
  headline: post.data.title,
  keywords: post.data.tags,
  /**
   * @todo fix the date formatting
   */
  ...(post.data.date && {
    datePublished: formatISO8601Local(post.data.date),
  }),
  ...(post.data.lastModified && {
    dateModified: formatISO8601Local(post.data.lastModified),
  }),
};
---

<script
  is:inline
  type="application/ld+json"
  set:html={JSON.stringify(schema)}
/>
