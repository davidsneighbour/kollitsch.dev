---
import { getCollection } from 'astro:content';
import Layout from '@layouts/DefaultPage.astro';
import TagCloud from '@components/TagCloud.astro';
import { getFilteredTagMap } from '@utils/getFilteredTagMap';

const blogPosts = await getCollection('blog');
const tagEntries = await getCollection('tags');

const tagMap = getFilteredTagMap(blogPosts);
const tagEntryList = tagEntries.filter((entry) => tagMap.has(entry.slug));



---

<Layout title="Tags">
  <h1 class="text-4xl font-bold mb-6">Tag Cloud</h1>
  <TagCloud tags={tagMap} />

  <h2 class="text-2xl font-bold mt-12 mb-4">Tag Pages</h2>
  <ul class="space-y-4">
    {tagEntryList.map((entry) => (
      <li>
        <a href={`/tags/${entry.slug}/`} class="text-lg font-semibold text-orange-700 hover:underline dark:text-orange-300">
          {entry.data.title || `#${entry.slug}`}
        </a>
        {entry.data.description && (
          <p class="text-sm text-gray-600 dark:text-gray-400">{entry.data.description}</p>
        )}
      </li>
    ))}
  </ul>
</Layout>
