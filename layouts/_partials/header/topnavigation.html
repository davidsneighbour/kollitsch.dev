{{- $config := site.Params.dnb.theme -}}
{{- partials.Include "func/hook.html" ( collections.Dictionary "hook" "header-topnav-pre" "context" . ) -}}
<div class="sticky-top">
  <nav class="navbar navbar-expand-md" aria-label="Top Navigation Bar">
    <div class="container-fluid">
      {{- partials.Include "func/hook.html" ( collections.Dictionary "hook" "header-topnav-start" "context" . ) -}}
      {{- /* Logo/Brand name */ -}}
      <div class="navbar-brand fsize-12 ff-headline">
        {{- if $config.logo -}}
        <a href="{{- site.BaseURL | urls.RelLangURL -}}" class="mt-2 d-inline-block text-decoration-none">
          <img class="rounded-circle" src="{{- $config.logo | urls.AbsURL  -}}"
              alt="Logo of {{ site.Title -}}"
              height="{{- $config.logo_height -}}"
              width="{{- $config.logo_width -}}">
        </a>
        {{- else -}}
        <a href="{{- site.BaseURL | urls.RelLangURL -}}" class="d-inline-block text-decoration-none text-hover-decoration-none">
          {{- site.Title -}}
        </a>
        {{- end -}}
      </div>
      {{- partials.Include "func/hook.html" ( collections.Dictionary "hook" "header-topnav-post-logo" "context" . ) -}}
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse"
        data-bs-target="#navbarContent"
        aria-controls="navbarContent" aria-expanded="false"
        aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
      {{- partials.Include "func/hook.html" ( collections.Dictionary "hook" "header-topnav-pre-mainnav" "context" . ) -}}
      <div class="collapse navbar-collapse" id="navbarContent">
        <menu class="mt-0 navbar-nav me-md-0 me-auto ms-auto">
          {{- $current := . -}}
          {{- range site.Menus.main -}}

            {{- $active := "" -}}
            {{- if or ($current.HasMenuCurrent .Menu .) ($current.IsMenuCurrent .Menu .) -}}
              {{- $active = "active text-primary link-primary" -}}
            {{- else  }}
              {{ if (and $current.IsHome (compare.Eq .Name "Home"))}}
                {{- $active = "active text-primary link-primary" -}}
              {{ end }}
            {{- end -}}

            {{- if .HasChildren -}}
              <li class="nav-item dropdown">
                <div
                  class="nav-link dropdown-toggle {{ $active }} lh-1 d-flex flex-row  justify-content-between gap-1 align-items-center"
                  {{- if $active }} aria-current="page" {{ end -}}
                  role="button"
                  data-bs-toggle="dropdown"
                  aria-expanded="false">
                  {{- with .Params.bsicon -}}
                    {{- partials.Include "icon.html" . -}}
                  {{- end -}}
                  {{- .Name -}}
                </div>
                <ul class="dropdown-menu">
                  {{- range .Children -}}
                    <li>
                      <a class="dropdown-item"
                        type="button"
                        href="{{- .URL | urls.AbsLangURL -}}"
                      {{- if $active }} aria-current="page" {{ end -}}
                          {{- with .Params.hotkey }} data-hotkey="{{ . }}"{{ end }}>
                        {{- with .Params.bsicon -}}
                          {{- partials.Include "icon.html" . -}}
                        {{- end -}}
                        {{- .Name -}}
                      </a>
                    </li>
                  {{- end -}}
                </ul>
              </li>
            {{- else -}}
              <li class="nav-item {{ $active }}">
                <a class="nav-link {{ $active }} lh-1 d-flex flex-row  justify-content-between gap-1 align-items-center"
                    href="{{- .URL | urls.AbsLangURL -}}"
                  {{- if $active }} aria-current="page" {{ end -}}
                          {{- with .Params.hotkey }} data-hotkey="{{ . }}"{{ end }}>
                  {{- with .Params.bsicon -}}
                    {{- partials.Include "icon.html" . -}}
                  {{- end -}}
                  <span>
                    {{- .Name -}}
                  </span>
                </a>
              </li>
            {{- end -}}
          {{- end -}}
          <li class="nav-item" id="themeswitcher" x-data="themeSwitcher()">
            <div
              title="Toggles between light and dark mode"
              aria-live="polite"
              x-on:click="toggleTheme"
              data-hotkey="k+t">
              <span :class="{ 'd-none': theme !== 'light', 'd-inline-block': theme === 'light' }" id="toggle-button-light" title="Switch to light mode">
                {{- partials.Include "icon.html" "sun-fill" -}}
              </span>
              <span :class="{ 'd-none': theme !== 'dark', 'd-inline-block': theme === 'dark' }" id="toggle-button-dark" title="Switch to dark mode">
                {{- partials.Include "icon.html" "moon-stars-fill" -}}
              </span>
            </div>
          </li>
        </menu>
      </div>
      {{- partials.Include "func/hook.html" ( collections.Dictionary "hook" "header-topnav-post-mainnav" "context" . ) -}}
      {{- partials.Include "func/hook.html" ( collections.Dictionary "hook" "header-topnav-end" "context" . ) -}}
    </div>
  </nav>
  <progress-bar></progress-bar>
</div>
{{- partials.Include "func/hook.html" ( collections.Dictionary "hook" "header-topnav-end" "context" . ) -}}
{{- partials.Include "func/hook.html" ( collections.Dictionary "hook" "header-topnav-pre-main" "context" . ) -}}
{{- partials.Include "func/hook.html" ( collections.Dictionary "hook" "header-topnav-post" "context" . ) -}}
