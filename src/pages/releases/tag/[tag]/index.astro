---
import { getMinorGroupTag, isSemverTag, loadAllReleases } from "@utils/releases.ts";

export async function getStaticPaths() {
  const all = await loadAllReleases();
  return all.map((r) => ({ params: { tag: r.tag } }));
}

const { params } = Astro;
const tag = params.tag ?? "";

if (!isSemverTag(tag)) {
  return Astro.redirect("/releases/");
}

const groupTag = getMinorGroupTag(tag);

if (!groupTag) {
  return Astro.redirect("/releases/");
}
---
{Astro.redirect(`/releases/${groupTag}/`)}
